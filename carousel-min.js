InfiniteCarousel=function(){var a=[],c,g,f;a.paddedclass="empty";a.cloneclass="clone";a.hitstart=!1;a.hitend=!1;a.duration=2;a.navigation=!0;a.buttonwidth=20;a.activeclass="onpage";a.gallerymode=!1;a.hoverpreview=!1;a.currentpage=-1;a.imagegroups=[];a.gesture={startx:0,endx:0};a.responsive=!1;a.initialised=!1;return{init:function(b,d){c=this;g=b;f=d;f.parentid&&(a.parentid=f.parentid,f.duration&&(a.duration=f.duration),f.navigation&&(a.navigation=!0),f.buttonwidth&&(a.buttonwidth=f.buttonwidth),f.responsive&& (a.responsive=!0),a.parent=g.one("#"+a.parentid),a.parentwidth=a.parent.getStyle("width"),a.viewport=a.parent.one(".wrapper").setStyle("overflow","hidden"),a.slider=a.parent.one("ul").setStyle("padding",0),c.setupAnimation())},setupAnimation:function(){a.animation=new g.Anim({node:a.slider,duration:a.duration,easing:g.Easing.easeBoth});a.animation.on("end",c.animationComplete);a.animating=!1;c.getItemDimensions()},destroy:function(){a.animation.destroy();a.parent.detachAll()},getItemDimensions:function(){var b= a.parent.one("ul li");a.itemwidth=parseInt(b.getStyle("width"),10)+parseInt(b.getStyle("paddingLeft"),10)+parseInt(b.getStyle("paddingRight"),10)+parseInt(b.getStyle("marginLeft"),10)+parseInt(b.getStyle("marginRight"),10)+"px";a.itemheight=b.getStyle("height");c.getViewportWidth()},getViewportWidth:function(){a.viewportwidth=a.viewport.getStyle("width");c.getPageData()},getPageData:function(){a.initialised||(a.currentpage=1,a.realitems=a.parent.all("ul li"),a.numberofitems=a.realitems.size(),a.numitemstoclone= Math.ceil(a.numberofitems/2));a.cloneoffset=a.numitemstoclone*parseInt(a.itemwidth,10);a.itemsperpage=Math.floor(parseInt(a.viewportwidth,10)/parseInt(a.itemwidth,10));a.wrapwidth=parseInt(a.itemwidth,10)*a.itemsperpage;a.gesture.minswipe=Math.floor(0.3*a.wrapwidth);a.numberofpages=Math.ceil(a.numberofitems/a.itemsperpage);c.setInitialView()},setInitialView:function(){a.fakestart="0px";a.realstart=-1*parseInt(a.itemwidth,10)*a.numitemstoclone+"px";a.realend=-1*(a.numitemstoclone+a.numberofitems-1)* parseInt(a.itemwidth,10)+"px";a.fakeend=-1*parseInt(a.itemwidth,10)*a.numberofitems+"px";a.initialised?(c.refreshNavigation(),a.lock=!1):(a.slider.setStyle("marginLeft",a.realstart),c.addPadding())},addPadding:function(){a.paddeditems=a.parent.all("ul li");c.createClones()},createClones:function(){var b;a.clones=[];a.clones.tip=[];a.paddeditems.slice(-1*a.numitemstoclone).each(c.cloneTip);a.clones.tip.reverse();for(b=0;b<a.numitemstoclone;b++)a.slider.prepend(a.clones.tip[b]);b=a.paddeditems.item(0).cloneNode(!0).addClass(a.cloneclass); a.slider.append(b);a.clones.tail=a.paddeditems.slice(1,a.numitemstoclone).each(c.cloneTail);c.createNavigation()},cloneTip:function(b){b=b.cloneNode(!0).addClass(a.cloneclass);a.clones.tip.push(b)},cloneTail:function(b){b=b.cloneNode(!0).addClass(a.cloneclass);a.slider.append(b)},refreshNavigation:function(){a.parent.all(".nav li").each(c.hideOrShowNavItem);a.currentpage=Math.floor(Math.abs((parseInt(a.slider.getStyle("marginLeft"),10)+a.cloneoffset)/parseInt(a.viewportwidth,10))+1);c.updateNavUI()}, updateNavUI:function(){a.parent.all(".nav li a").removeClass(a.activeclass).item(a.currentpage-1).addClass(a.activeclass)},hideOrShowNavItem:function(b,c){c+1>a.numberofpages?b.addClass("hide"):b.removeClass("hide")},createNavigation:function(){var b="",d="",e;if(a.navigation){b+="<div class='nav'><ul style='width:"+a.numberofitems*a.buttonwidth+"px;' class='clearfix'>";for(e=1;e<=a.numberofitems;e++)d=1===e?"class='"+a.activeclass+"' ":"",b+="<li><a "+d+"href='#"+e+"'>"+e+"</a></li>";b+="</ul></div>"}a.parent.append(b+ '<a href="#back" class="arrow back">&lt;</a><a href="#forward" class="arrow forward">&gt;</a>');a.parent.all(".nav li").each(c.hideOrShowNavItem);c.listen()},scrollToPage:function(b){a.jsonitems&&c.fireloadevent(b);var d=-1*a.numitemstoclone*parseInt(a.itemwidth,10)+-1*parseInt(a.itemwidth,10)*a.itemsperpage*(b-1);b==a.numberofpages+1&&(d=-1*(a.cloneoffset+a.numberofitems*parseInt(a.itemwidth,10)));a.animation.set("to",{marginLeft:d});c.animate()},animate:function(){a.animating||(a.animating=!0,a.animation.run())}, animationComplete:function(){a.hitstart?(a.slider.setStyle("marginLeft",a.realstart),a.hitstart=!1,a.currentpage=1):a.hitend&&(a.slider.setStyle("marginLeft",a.realend),a.hitend=!1,a.currentpage=a.numberofpages);a.animating=!1;a.navigation&&c.updateNavUI()},handleClick:function(b){if(!a.lock){var d=b.target,e=-1;d.test("a")&&d.ancestor(".nav")?(b.preventDefault(),a.animating||(e=d.get("innerHTML"),c.scrollToPage(e),a.currentpage=e)):d.test("a")&&d.hasClass("arrow")&&(b.preventDefault(),a.animating|| (d.hasClass("forward")?e=a.currentpage+1:d.hasClass("back")&&(e=a.currentpage-1),0>=e?a.hitend=!0:e>a.numberofpages&&(a.hitstart=!0),c.scrollToPage(e),a.currentpage=e))}},listen:function(){g.on("click",c.handleClick,a.parent,c,{});a.viewport.on("gesturemovestart",c.startGesture);a.viewport.on("gesturemove",c.moveGesture);a.viewport.on("gesturemoveend",c.endGesture);a.viewport.delegate("click",c.scrollOrClick,"a");a.responsive&&c.listenForResize();a.initialised=!0},listenForResize:function(){setInterval(function(){var b= parseInt(a.parentwidth,10),d=parseInt(a.parent.getStyle("width"),10);if(d>a.itemwidth*a.numberofitems)c.debug("The container of the carousel is too large for the content");else if(!a.lock&&b!=d)a.lock=!0,a.parentwidth=d+"px";else if(a.lock||b!=d)a.lock=!1,c.getItemDimensions(!0)},700)},startGesture:function(b){a.lock||(c.preventDefault(b),a.gesture.startx=b.pageX,a.gesture.lastx=b.pageX,a.gesture.lastscrolledamt=0)},moveGesture:function(b){if(!a.lock){c.preventDefault(b);var d=a.gesture.startx-b.pageX, e=Math.abs(d);!c.hitEnd(d)&&!(a.wrapwidth<=e)&&(d=parseInt(a.slider.getStyle("marginLeft"),10),a.gesture.lastx<b.pageX?a.slider.setStyle("marginLeft",d+Math.abs(a.gesture.lastx-b.pageX)):a.slider.setStyle("marginLeft",d-Math.abs(a.gesture.lastx-b.pageX)),a.gesture.lastx=b.pageX)}},endGesture:function(b){if(!a.lock&&(c.preventDefault(b),a.gesture.endx=b.pageX,b=a.gesture.startx-a.gesture.endx,!c.hitEnd(b))){var b=Math.abs(b),d=a.gesture.startx>a.gesture.endx?"right":"left",e=null;if(b>=a.gesture.minswipe)switch(d){case "left":e= a.currentpage-1;0>=e&&(a.hitend=!0);c.scrollToPage(e);a.currentpage=e;break;case "right":e=a.currentpage+1,e>a.numberofpages&&(a.hitstart=!0),c.scrollToPage(e),a.currentpage=e}else c.scrollToPage(a.currentpage);a.gesture.lastscrolledamt=b}},hitEnd:function(b){return 1===a.currentpage&&b<-1*a.itemwidth||a.currentpage===a.numberofpages&&b>a.itemwidth?!0:!1},scrollOrClick:function(b){2<a.gesture.lastscrolledamt&&c.preventDefault(b)},preventDefault:function(a){a&&a.preventDefault&&a.preventDefault()}, debug:function(a){"undefined"!==typeof console&&console.log(a)}}};